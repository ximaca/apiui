<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>接口测试页</title>
    <style>
        .head-title {
            line-height: 2em;
            font-size: 2em;
        }
        .head-title .setting-icon {
            vertical-align: middle;
        }
        .u-action {
            padding: 5px 15px;
            border: 1px solid #e0f2fe;
            border-radius: 9999px;
            background-color: #f0f9ff;
            color: #0284c7;
            font-size: 16px;
            cursor: pointer;
            transition: .2s all linear;
        }
        .u-action:hover {
            border-color: #0284c7;
            box-shadow: rgba(0,0,0,.15) 1.95px 1.95px 2.6px;
        }
        .u-action-orange {
            border: 1px solid #ffdd1f;
            background-color: #fff9dc;
            color: #ff712a;
        }
        .u-action-orange:hover {
            border-color: #ff8d10;
        }
        .description-text {
            font-size: 12px;
            color: #ccc;
        }
        .result-box {
            overflow: auto;
            min-height: 50px;
            max-height: 200px;
            padding: 5px;
            border: 1px dashed grey;
            white-space: pre-wrap;
        }
        .result-box:empty::after {
            content: attr(data-placeholder);
            color: #E0E0E0;
        }
    </style>
</head>
<body>

    <div style="width: 700px; margin: 0 auto;">
        <h1 class="head-title">
            请求接口查看结果
            <!-- 设置按钮 -->
            <a href="#settingPanel" rel="modal:open" class="setting-icon" id="settingIcon">
                <img width="30px" height="30px" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjgiIGhlaWdodD0iMTI4IiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9IiNjY2NjY2MiIGQ9Ik0xOS45IDEyLjY2YTEgMSAwIDAgMSAwLTEuMzJsMS4yOC0xLjQ0YTEgMSAwIDAgMCAuMTItMS4xN2wtMi0zLjQ2YTEgMSAwIDAgMC0xLjA3LS40OGwtMS44OC4zOGExIDEgMCAwIDEtMS4xNS0uNjZsLS42MS0xLjgzYTEgMSAwIDAgMC0uOTUtLjY4aC00YTEgMSAwIDAgMC0xIC42OGwtLjU2IDEuODNhMSAxIDAgMCAxLTEuMTUuNjZMNSA0Ljc5YTEgMSAwIDAgMC0xIC40OEwyIDguNzNhMSAxIDAgMCAwIC4xIDEuMTdsMS4yNyAxLjQ0YTEgMSAwIDAgMSAwIDEuMzJMMi4xIDE0LjFhMSAxIDAgMCAwLS4xIDEuMTdsMiAzLjQ2YTEgMSAwIDAgMCAxLjA3LjQ4bDEuODgtLjM4YTEgMSAwIDAgMSAxLjE1LjY2bC42MSAxLjgzYTEgMSAwIDAgMCAxIC42OGg0YTEgMSAwIDAgMCAuOTUtLjY4bC42MS0xLjgzYTEgMSAwIDAgMSAxLjE1LS42NmwxLjg4LjM4YTEgMSAwIDAgMCAxLjA3LS40OGwyLTMuNDZhMSAxIDAgMCAwLS4xMi0xLjE3Wk0xOC40MSAxNGwuOC45bC0xLjI4IDIuMjJsLTEuMTgtLjI0YTMgMyAwIDAgMC0zLjQ1IDJMMTIuOTIgMjBoLTIuNTZMMTAgMTguODZhMyAzIDAgMCAwLTMuNDUtMmwtMS4xOC4yNGwtMS4zLTIuMjFsLjgtLjlhMyAzIDAgMCAwIDAtNGwtLjgtLjlsMS4yOC0yLjJsMS4xOC4yNGEzIDMgMCAwIDAgMy40NS0yTDEwLjM2IDRoMi41NmwuMzggMS4xNGEzIDMgMCAwIDAgMy40NSAybDEuMTgtLjI0bDEuMjggMi4yMmwtLjguOWEzIDMgMCAwIDAgMCAzLjk4bS02Ljc3LTZhNCA0IDAgMSAwIDQgNGE0IDQgMCAwIDAtNC00bTAgNmEyIDIgMCAxIDEgMi0yYTIgMiAwIDAgMS0yIDIiLz48L3N2Zz4=" alt="">
            </a>
        </h1>

        <div>
            <p>
                说明： 使用 <span id="apiText">https://api.yujn.cn/api/manzhan.php?type=video</span> 接口。
                <a id="apiDoc" href="https://www.yujn.cn/?action=interface&id=349" target="_blank" rel="noopener noreferrer">查看接口文档</a>

                <br>
                <!-- 特别说明 -->
                <span class="description-text">若接口不支持跨域，则会提示操作失败</span>
            </p>
            <div>
                <span>查询字符串参数：</span>

                <span id="jsonParamButton" style="margin-left: 50px; font-size: 12px; color: #0284c7; cursor: pointer; line-height: 22px; vertical-align: text-top;">
                    切换为JSON参数
                </span>
            </div>
            <div>
                <textarea id="urlText" rows="5" style="width: 100%;" placeholder="a=1&b=2"></textarea>
            </div>
            <div>
                <p style="margin: 10px 0 30px;">
                    <span class="u-action u-action-start" id="startButton">开始请求</span>
                </p>
            </div>

            <hr>
            <div>
                <span>操作结果</span>
            </div>
            <div>
                <div>
                    <pre class="result-box" id="resultBox" data-placeholder="未开始"></pre>

                    <!-- 对结果的操作 -->
                    <p style="display: none;" id="resultActionBox">
                        <a id="openVideoButton" href="#" target="_blank" rel="noopener noreferrer" style="text-decoration: none;">
                            <span class="u-action u-action-result" id="resultActionButton">执行</span>
                        </a>
                    </p>
                </div>
            </div>
        </div>

        <!-- 设置面板 -->
        <div style="display: none;">
            <div id="settingPanel" class="modal">
                <h2 style="margin-top: 0;">设置面板</h2>
                <p>
                    当前测试接口： 
                    <span id="apiText2">-</span>
                </p>
                <p>
                    切换测试接口：
                    <select id="apiSettingSelect">
                        <optgroup label="小姐姐视频">
                            <option value="pear_xjj">随机小姐姐视频</option>
                            <option value="new_sister_video">新小姐姐视频【云端版】（速度较慢）</option>
                            <option value="girls_video">小姐姐视频_分区版（早期接口，做了特殊处理）</option>
                            <option value="kuleu_xjj">随机性感小姐姐视频</option>
                            <option value="meinv_video">随机美女视频</option>
                            <option value="nvdaxuesheng">快手女大学生系列视频-直接跳转</option>
                            <option value="sjsp_video">随机小姐姐视频-直接跳转</option>
                            <option value="juhexjj">随机输出各种类型小姐姐-直接跳转</option>
                            <option value="shwd">丝滑舞蹈视频-直接跳转</option>
                            <option value="wmsc">身材系列视频-直接跳转</option>
                            <option value="baisis">白丝视频-直接跳转</option>
                            <option value="heisis">黑丝视频-直接跳转</option>
                        </optgroup>
                        <optgroup label="漫展视频">
                            <option value="manzhan">漫展现场随机视频</option>
                        </optgroup>
                    </select>
                </p>
                <a href="#" rel="modal:close" style="text-decoration: none; float: right;">
                    <span class="u-action u-action-setting-ok" id="settingOkButton">确定</span>
                </a>
            </div>
        </div>
    </div>

    <script src="./lib/jquery-v3.6.0.min.js"></script>
    <link rel="stylesheet" href="./lib/toastr.min.css">
    <script src="./lib/toastr.min.js"></script>
    <script>
        var apiUrl = {
            // 随机返回一条小姐姐视频
            pear_xjj: {
                url: "https://tools.mgtv100.com/external/v1/pear/xjj",
                doc: "https://api.aa1.cn/doc/pear_xjj.html",
                dataType: "json",
                requireParam: false,
                success: {
                    buttonText: "直接打开播放视频",
                    // action属性的简化配置
                    openUrl: (data) => data.data,
                },
            },
            // 新小姐姐视频【云端版】(本接口对接NAS资源实时更新数据均采用国内高速服务器，视频资源均有网友提供。)
            new_sister_video: {
                // 该接口播放视频成功率不高，接口响应速度也不够快
                url: "https://api.mhimg.cn/api/New_sister_video/",
                doc: "https://api.aa1.cn/doc/New_sister_video.html",
                dataType: "json",
                requireParam: false,
                success: {
                    buttonText: "打开视频",
                    action: (data, textStatus, jqXHR) => {
                        var url = data.videos && data.videos[0] && data.videos[0].video_url;
                        url && window.open(url, "_blank");
                    },
                },
            },
            // 小姐姐视频_分区版 接口（该接口结果会302到 mp4资源地址）
            girls_video: {
                url: "./",
                doc: "https://api.aa1.cn/doc/girls_video.html",
                // 显示页面内容文本
                dataType: "text",
                requireParam: false,
                success: {
                    buttonText: "直接打开播放视频",
                    action: (data, textStatus, jqXHR) => {
                        // 默认为随机视频，参数值见飞书文档 https://iatuqyq5dtq.feishu.cn/sheets/JXqAsPXWLhvquUtB2nec6z6onoh
                        var param = $("#urlText").val() || "all";
                        var url = "https://api.mhimg.cn/api/girls_video/?sort=" + param;
                        url && window.open(url, "_blank");
                    },
                },
            },
            // 【不支持跨域】小姐姐短视频，「随机」遍历目录下文件，视频数据来源于自媒体平台
            api_girl_can_not_cors: {
                /*
                    3种请求方式：
                    直接请求 https://tucdn.wpon.cn/api-girl/index.php 会返回 <video>标签 静音播放视频。
                    若请求 http://tucdn.wpon.cn/api-girl/index.php?wpon=url 则会返回一个 mp4地址文本。
                    【不支持跨域】第三种是下面在用请求 https://tucdn.wpon.cn/api-girl/index.php?wpon=json 。

                    此接口还有 https://tucdn.wpon.cn/api-girl/videos/1.mp4 - https://tucdn.wpon.cn/api-girl/videos/141.mp4 共141个视频文件。
                */
                url: "https://tucdn.wpon.cn/api-girl/index.php?wpon=json",
                doc: "https://api.aa1.cn/doc/girl.html",
                dataType: "json",
                requireParam: false,
                success: {
                    buttonText: "新窗口打开",
                    action: (data, textStatus, jqXHR) => {
                        // var url = data.xxx;
                        // url && window.open(url, "_blank");
                    },
                },
            },
            // 【不支持跨域】快手女大学生系列视频
            nvdaxuesheng: {
                // 用新窗口打开的方式来测试
                url: "https://api.yujn.cn/api/nvda.php?type=video",
                doc: "https://www.yujn.cn/?action=interface&id=384",
                dataType: "video-binary-stream",
            },
            // 随机性感小姐姐视频
            kuleu_xjj: {
                url: "https://api.kuleu.com/api/xjj?type=json",
                doc: "https://api.aa1.cn/doc/jkllt.html",
                dataType: "json",
                requireParam: false,
                success: {
                    buttonText: "直接打开播放视频",
                    action: (data, textStatus, jqXHR) => {
                        var url = data.video;
                        url && window.open(url, "_blank");
                    },
                },
            },
            // 随机美女视频
            meinv_video: {
                // 带参数可以直接返回mp4文件： https://v2.api-m.com/api/meinv?return=302
                url: "https://v2.api-m.com/api/meinv",
                doc: "https://api.aa1.cn/doc/meinv.html",
                dataType: "json",
                requireParam: false,
                success: {
                    buttonText: "新窗口打开",
                    // action属性的简化配置
                    openUrl: (data) => data.data,
                },
            },
            // 随机小姐姐视频
            sjsp_video: {
                url: "https://jx.iqfk.top/api/sjsp.php",
                doc: "https://api.aa1.cn/doc/dxhy-xjj.html",
                dataType: "video-binary-stream",
            },
            // 【不支持跨域】小姐姐类资源视频，随机输出各种类型
            juhexjj: {
                // 用新窗口打开的方式来测试
                url: "http://api.yujn.cn/api/juhexjj.php?type=video",
                doc: "https://www.yujn.cn/?action=interface&id=224",
                dataType: "video-binary-stream",
            },
            // 【不支持跨域】随机返回丝滑舞蹈视频
            shwd: {
                // 用新窗口打开的方式来测试
                url: "http://api.yujn.cn/api/shwd.php?type=video",
                doc: "https://www.yujn.cn/?action=interface&id=304",
                dataType: "video-binary-stream",
            },
            // 【不支持跨域】返回身材系列视频
            wmsc: {
                // 用新窗口打开的方式来测试
                url: "http://api.yujn.cn/api/wmsc.php?type=video",
                doc: "https://www.yujn.cn/?action=interface&id=305",
                dataType: "video-binary-stream",
            },
            // 【不支持跨域】白丝视频
            baisis: {
                // 用新窗口打开的方式来测试
                url: "http://api.yujn.cn/api/baisis.php?type=video",
                doc: "https://www.yujn.cn/?action=interface&id=166",
                dataType: "video-binary-stream",
            },
            // 【不支持跨域】黑丝视频
            heisis: {
                // 用新窗口打开的方式来测试
                url: "http://api.yujn.cn/api/heisis.php?type=video",
                doc: "https://www.yujn.cn/?action=interface&id=167",
                dataType: "video-binary-stream",
            },
            // 【不支持跨域】漫展现场随机视频
            manzhan: {
                // 用新窗口打开的方式来测试
                url: "https://api.yujn.cn/api/manzhan.php?type=video",
                doc: "https://www.yujn.cn/?action=interface&id=349",
                dataType: "video-binary-stream",
            },
            // XX接口
            aaa: {
                url: "https://aaa",
                doc: "https://aaa",
                dataType: "json",
                requireParam: false,
                // success: {
                //     buttonText: "新窗口打开",
                //     action: (data, textStatus, jqXHR) => {
                //         var url = data.xxx;
                //         url && window.open(url, "_blank");
                //     },
                //     openUrl: (data) => data.data,
                // },
            },
            current: "new_sister_video",
        };

        $(function () {
            var toastr = new Toastr();

            var getParamText = () => {
                var paramText = $("#urlText").val();
                paramText = $.trim(paramText);

                return paramText;
            };
            // 更新api信息
            var updateApiText = (name) => {
                if (!apiUrl[name]) {
                    return;
                }
                if (name === apiUrl.current) {
                    return;
                }
                apiUrl.current = name;
                var apiData = apiUrl[name];
                $("#apiText").text(apiData.url);
                $("#apiDoc").attr("href", apiData.doc);

                // 更新设置面板的值
                $("#apiSettingSelect").val(name);
                $("#apiText2").text(apiData.url);
            };

            // 初始化
            // updateApiText(apiUrl.current);
            // updateApiText("new_sister_video");
            // updateApiText("girls_video");
            // updateApiText("nvdaxuesheng");
            // updateApiText("kuleu_xjj");
            // updateApiText("meinv_video");
            // updateApiText("sjsp_video");
            // updateApiText("juhexjj");
            // updateApiText("shwd");
            // updateApiText("wmsc");
            // updateApiText("baisis");
            // updateApiText("heisis");
            updateApiText("manzhan");

            $("#startButton").click(function () {
                var apiConfig = apiUrl[apiUrl.current];
                var paramText = getParamText();
                if (apiConfig.requireParam && !paramText) {
                    toastr.show("参数不能为空，请重新输入");
                    return;
                }

                // 支持新的类型，直接打开新窗口测接口
                if (apiConfig.dataType === "video-binary-stream") {
                    window.open(apiConfig.url + paramText, "_blank");
                    return;
                }

                $("#resultBox").attr("data-placeholder", "进行中...");

                $.ajax({
                    url: apiConfig.url,
                    data: {
                        // aaa: paramText
                    },
                    dataType: apiConfig.dataType || "json",
                    // 超时设置
                    timeout: 300e5,
                    success: function (data, textStatus, jqXHR) {
                        console.log(data);
                        if (!apiConfig.dataType || (apiConfig.dataType === "json")) {
                            $("#resultBox").text(JSON.stringify(data, null, 4));
                        }
                        else if ((apiConfig.dataType === "text") || apiConfig.dataType === "html") {
                            $("#resultBox").text(data);
                        }

                        toastr.show("已返回操作结果，请查看");

                        // 展示 结果执行按钮
                        if (apiConfig.success) {
                            $("#resultActionBox").show();
                            // 先重置事件
                            $("#openVideoButton")
                                .unbind()
                                .attr("href", "#");

                            if (apiConfig.success.buttonText) {
                                $("#resultActionButton").text(apiConfig.success.buttonText);
                            }
                            // 绑定新事件
                            if (apiConfig.success.action) {
                                $("#openVideoButton").click(function () {
                                    apiConfig.success.action(data, textStatus, jqXHR, this);
                                    return false;
                                });
                            }
                            // 打开新窗口的链接
                            else if (apiConfig.success.openUrl) {
                                $("#openVideoButton").attr("href", apiConfig.success.openUrl(data));
                            }
                        }
                        else {
                            // 直接隐藏 结果执行按钮
                            $("#resultActionBox").hide();
                        }
                    },
                    error: function (jqXHR, textStatus, errorThrown) {
                        toastr.show("操作失败，请重试");
                        // 填充失败信息
                        $("#resultBox").attr("data-placeholder", "操作失败").text("");
                        // 隐藏执行按钮
                        $("#resultActionBox").hide();

                        console.log(jqXHR, textStatus, errorThrown);
                    },
                });
            });

            // 切换为JSON参数
            $("#jsonParamButton").click(() => {
                toastr.show("功能开发中...");
            });

            // 打开设置面板
            $("#settingIcon").click(function () {
                // 更新下拉框的值
                $("#apiSettingSelect").val(apiUrl.current);
            });
            // 完成设置
            $("#settingOkButton").click(function () {
                updateApiText($("#apiSettingSelect").val());
            });
        });
    </script>

    <link rel="stylesheet" href="./lib/jquery.modal-0.9.1.min.css">
    <script src="./lib/jquery.modal-0.9.1.min.js" defer></script>
</body>
</html>
